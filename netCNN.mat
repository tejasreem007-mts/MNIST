[XTrain, YTrain] = digitTrain4DArrayData;
[XTest, YTest] = digitTest4DArrayData;

layersCNN = [
    imageInputLayer([28 28 1],'Normalization','none')
    convolution2dLayer(3,32,'Padding','same')
    reluLayer
    maxPooling2dLayer(2,'Stride',2)
    convolution2dLayer(3,64,'Padding','same')
    reluLayer
    maxPooling2dLayer(2,'Stride',2)
    fullyConnectedLayer(128)
    reluLayer
    dropoutLayer(0.5)
    fullyConnectedLayer(10)
    softmaxLayer
    classificationLayer
];

optionsCNN = trainingOptions('adam', ...
    'MaxEpochs',10, ...
    'MiniBatchSize',128, ...
    'ValidationData',{XTest,YTest}, ...
    'Verbose',false, ...
    'Plots','training-progress');

netCNN = trainNetwork(XTrain,YTrain,layersCNN,optionsCNN);

save netCNN.mat netCNN
